function OVV(){this.DEBUG=false;this.IN_IFRAME=(window.top!==window.self);this.asset=null;var h=window.testOvvConfig&&window.testOvvConfig.userAgent?window.testOvvConfig.userAgent:navigator.userAgent;function g(k){var j=function(){var q={ID:0,name:"",version:""};var p=k;for(var n=0;n<l.length;n++){if(p.match(new RegExp(l[n].brRegex))!=null){q.ID=l[n].id;q.name=l[n].name;if(l[n].verRegex==null){break}var o=p.match(new RegExp(l[n].verRegex+"[0-9]*"));if(o!=null){var m=o[0].match(new RegExp(l[n].verRegex));q.version=o[0].replace(m[0],"")}break}}return q};var l=[{id:4,name:"Opera",brRegex:"OPR|Opera",verRegex:"(OPR/|Version/)"},{id:1,name:"MSIE",brRegex:"MSIE|Trident/7.*rv:11|rv:11.*Trident/7",verRegex:"(MSIE |rv:)"},{id:2,name:"Firefox",brRegex:"Firefox",verRegex:"Firefox/"},{id:3,name:"Chrome",brRegex:"Chrome",verRegex:"Chrome/"},{id:5,name:"Safari",brRegex:"Safari|(OS |OS X )[0-9].*AppleWebKit",verRegex:"Version/"}];return j()}this.browserIDEnum={MSIE:1,Firefox:2,Chrome:3,Opera:4,safari:5};this.browser=g(h);this.interval=Number("INTERVAL");this.version="VERSION";var d={};var c=[];var f=1000;var a=[];this.addAsset=function(j){if(!d.hasOwnProperty(j.getId())){d[j.getId()]=j;this.asset=j}};this.removeAsset=function(j){delete d[j.getId()]};this.getAssetById=function(j){return d[j]};this.getAds=function(){var k={};for(var j in d){if(d.hasOwnProperty(j)){k[j]=d[j]}}return k};this.subscribe=function(k,j,l,m){if(m){for(key in c[j]){if(b(c[j][key].eventName,k)){e(function(){l(j,c[j][key])})}}}for(key in k){if(!a[k[key]+j]){a[k[key]+j]=[]}a[k[key]+j].push({Func:l})}};this.publish=function(l,o,m){var k={eventName:l,eventTime:i(),ovvArgs:m};if(!c[o]){c[o]=[]}if(c[o].length<f){c[o].push(k)}if(l&&o&&a[l+o] instanceof Array){for(var n=0;n<a[l+o].length;n++){var j=a[l+o][n];if(j&&j.Func&&typeof j.Func==="function"){e(function(){j.Func(o,k)})}}}};var i=function(){if(Date.now){return Date.now()}return(new Date()).getTime()};var b=function(k,l){for(var j=0;j<l.length;j++){if(l[j]===k){return true}}return false};var e=function(k){try{var j=k();return j!==undefined?j:true}catch(l){return false}}}function OVVCheck(){this.clientHeight=-1;this.clientWidth=-1;this.error="";this.focus=null;this.fps=-1;this.id="";this.beaconsSupported=null;this.geometrySupported=null;this.geometryViewabilityState="";this.beaconViewabilityState="";this.technique="";this.beacons=new Array();this.inIframe=null;this.objBottom=-1;this.objLeft=-1;this.objRight=-1;this.objTop=-1;this.percentViewable=-1;this.viewabilityState=""}OVVCheck.UNMEASURABLE="unmeasurable";OVVCheck.VIEWABLE="viewable";OVVCheck.UNVIEWABLE="unviewable";OVVCheck.NOT_READY="not_ready";OVVCheck.BEACON="beacon";OVVCheck.GEOMETRY="geometry";function OVVAsset(p){var u=13;var H=Math.sqrt(2);var b=0;var G=1;var m=2;var z=3;var E=4;var A=5;var e=6;var x=7;var c=8;var l=9;var d=10;var D=11;var s=12;var h=13;var t=p;var y=0;var C=$ovv.DEBUG?20:1;var g;var v;var k=null;var F=0;this.checkViewability=function(){var K=new OVVCheck();K.id=t;K.inIframe=$ovv.IN_IFRAME;K.geometrySupported=!$ovv.IN_IFRAME;K.focus=f();if(!v){K.error="Player not found!";return K}if(($ovv.browser.ID===$ovv.browserIDEnum.MSIE||$ovv.browser.ID===$ovv.browserIDEnum.Firefox)&&$ovv.IN_IFRAME){K.viewabilityState=OVVCheck.UNMEASURABLE;if(!$ovv.DEBUG){return K}}if(K.geometrySupported){K.technique=OVVCheck.GEOMETRY;j.bind(this)(K,v);K.viewabilityState=(K.percentViewable>=50)?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE;if($ovv.DEBUG){K.geometryViewabilityState=K.viewabilityState}else{return K}}var N=B(0);if(N&&N.isViewable){var M=i(N)&&N.isViewable();K.beaconsSupported=!M}else{K.beaconsSupported=false}if(!o()){K.technique=OVVCheck.BEACON;K.viewabilityState=OVVCheck.NOT_READY}else{if(K.beaconsSupported){K.technique=OVVCheck.BEACON;var J=a.bind(this)(K);if(J===null){K.viewabilityState=OVVCheck.UNMEASURABLE;if($ovv.DEBUG){K.beaconViewabilityState=OVVCheck.UNMEASURABLE}}else{K.viewabilityState=J?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE;if($ovv.DEBUG){K.beaconViewabilityState=J?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE}}}else{K.viewabilityState=OVVCheck.UNMEASURABLE}}if($ovv.DEBUG){K.technique="";if(K.geometryViewabilityState===null&&K.beaconViewabilityState===null){K.viewabilityState=OVVCheck.UNMEASURABLE}else{var L=(K.beaconViewabilityState===OVVCheck.VIEWABLE);var I=(K.geometryViewabilityState===OVVCheck.VIEWABLE);K.viewabilityState=(L||I)?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE}}return K};this.beaconStarted=function(I){if($ovv.DEBUG){B(I).debug()}if(I===0){return}y++;if(o()){v.startImpressionTimer()}};this.dispose=function(){for(var J=1;J<=u;J++){var I=q(J);if(I){delete y[J];I.parentElement.removeChild(I)}}window.$ovv.removeAsset(this)};this.getId=function(){return t};this.getPlayer=function(){return v};var j=function(J,P){J.clientWidth=Infinity;J.clientHeight=Infinity;if(!isNaN(document.body.clientWidth)&&document.body.clientWidth>0){J.clientWidth=document.body.clientWidth}if(!isNaN(document.body.clientHeight)&&document.body.clientHeight>0){J.clientHeight=document.body.clientHeight}if(!!document.documentElement&&!!document.documentElement.clientWidth&&!isNaN(document.documentElement.clientWidth)){J.clientWidth=document.documentElement.clientWidth}if(!!document.documentElement&&!!document.documentElement.clientHeight&&!isNaN(document.documentElement.clientHeight)){J.clientHeight=document.documentElement.clientHeight}if(!!window.innerWidth&&!isNaN(window.innerWidth)){J.clientWidth=Math.min(J.clientWidth,window.innerWidth)}if(!!window.innerHeight&&!isNaN(window.innerHeight)){J.clientHeight=Math.min(J.clientHeight,window.innerHeight)}if(J.clientHeight==Infinity||J.clientWidth==Infinity){J={error:"Failed to determine viewport"}}else{var L=P.getClientRects()[0];J.objTop=L.top;J.objBottom=L.bottom;J.objLeft=L.left;J.objRight=L.right;if(L.bottom<0||L.right<0||L.top>J.clientHeight||L.left>J.clientWidth){J.percentViewable=0}else{var O=(L.right-L.left)*(L.bottom-L.top);var I=Math.ceil(Math.max(0,L.left));var N=Math.floor(Math.min(J.clientWidth,L.right));var Q=Math.ceil(Math.max(0,L.top));var M=Math.floor(Math.min(J.clientHeight,L.bottom));var K=(N-I+1)*(M-Q+1);J.percentViewable=Math.floor(K/O*100)}}};var a=function(I){if(!o()){return null}var P=0;var M=0;var R=0;var S=0;I.beacons=new Array(u);var L=v.getClientRects()[0];I.objTop=L.top;I.objBottom=L.bottom;I.objLeft=L.left;I.objRight=L.right;for(var N=0;N<=u;N++){var J=B(N);var K=J.isViewable();var Q=i(J);I.beacons[N]=K&&Q;if(N===0){continue}if(K){P++;switch(N){case m:case z:case E:case A:M++;break;case e:case x:case c:case l:R++;break;case d:case D:case s:case h:S++;break}}}if(P===u){return true}var O=I.beacons;if((O[G]===true)&&(O[m]===true&&O[z]==true)||(O[m]===true&&O[E]==true)||(O[z]===true&&O[A]==true)||(O[E]===true&&O[A]==true)){return true}if(O[G]===false&&S>=3){return true}if(O[G]===true&&R==4){return true}if((O[m]&&O[A])&&(!O[e]||![d]||!O[G]||O[h]||O[l])){return null}if((O[E]&&O[z])&&(!O[c]||!O[s]||!O[G]||!O[D]||!O[x])){return null}return false};var o=function(){if(!v){return false}return y===u};var r=function(J){if(J===""||J===("BEACON_SWF_URL")){return}for(var I=0;I<=u;I++){var L=document.createElement("DIV");L.id="OVVBeaconContainer_"+I+"_"+t;L.style.position="absolute";L.style.zIndex=$ovv.DEBUG?99999:-99999;var K='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+C+'" height="'+C+'"><param name="movie" value="'+J+"?id="+t+"&index="+I+'" /><param name="quality" value="low" /><param name="bgcolor" value="#ffffff" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><!--[if !IE]>--><object id="OVVBeacon_'+I+"_"+t+'" type="application/x-shockwave-flash" data="'+J+"?id="+t+"&index="+I+'" width="'+C+'" height="'+C+'"><param name="quality" value="low" /><param name="bgcolor" value="#ff0000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><!--<![endif]--></object>';L.innerHTML=K;document.body.insertBefore(L,document.body.firstChild)}w.bind(this)();setInterval(w.bind(this),500)};var w=function(){if(!o()){return}var L=v.getClientRects()[0];if(g&&(g.left===L.left&&g.right===L.right&&g.top===L.top&&g.bottom===L.bottom)){return}g=L;var J=L.right-L.left;var R=L.bottom-L.top;var O=J/(1+H);var I=R/(1+H);var M=J/H;var Q=R/H;for(var N=0;N<=u;N++){var K=L.left+document.body.scrollLeft;var P=L.top+document.body.scrollTop;switch(N){case b:K=-100000;P=-100000;break;case G:K+=(J-C)/2;P+=(R-C)/2;break;case m:break;case z:K+=J-C;break;case E:P+=R-C;break;case A:K+=J-C;P+=R-C;break;case e:K+=(J-M)/2;P+=(R-Q)/2;break;case x:K+=((J-M)/2)+M;P+=(R-Q)/2;break;case c:K+=(J-M)/2;P+=((R-Q)/2)+Q;break;case l:K+=((J-M)/2)+M;P+=((R-Q)/2)+Q;break;case d:K+=(J-O)/2;P+=(R-I)/2;break;case D:K+=((J-O)/2)+O;P+=(R-I)/2;break;case s:K+=(J-O)/2;P+=((R-I)/2)+I;break;case h:K+=((J-O)/2)+O;P+=((R-I)/2)+I;break}if(N>=e){K-=(C/2);P-=(C/2)}var S=q(N);S.style.left=K+"px";S.style.top=P+"px"}};var i=function(I){if(!I){return false}var J=Math.max(document.body.clientWidth,window.innerWidth);var L=Math.max(document.body.clientHeight,window.innerHeight);var K=I.getClientRects()[0];return(K.top<L&&K.bottom>0&&K.left<J&&K.right>0)};var B=function(I){return document.getElementById("OVVBeacon_"+I+"_"+t)};var q=function(I){return document.getElementById("OVVBeaconContainer_"+I+"_"+t)};var n=function(){var J=document.getElementsByTagName("embed");for(var I=0;I<J.length;I++){if(J[I][t]){return J[I]}}var K=document.getElementsByTagName("object");for(var I=0;I<K.length;I++){if(K[I][t]){return K[I]}}return null};var f=function(){var I=true;if(typeof document.hidden!=="undefined"){I=window.document.hidden?false:true}else{if(document.hasFocus){I=document.hasFocus()}}if($ovv.IN_IFRAME===false&&I===true&&document.hasFocus){I=document.hasFocus()}return I};v=n();if($ovv.IN_IFRAME||$ovv.DEBUG){r.bind(this)("BEACON_SWF_URL")}else{if(v&&v.startImpressionTimer){v.startImpressionTimer()}}}window.$ovv=window.$ovv||new OVV();window.$ovv.addAsset(new OVVAsset("OVVID"));
