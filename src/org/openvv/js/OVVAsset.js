function OVV(){this.DEBUG=false;this.IN_IFRAME=(window.top!==window.self);this.asset=null;this.positionInterval=null;var h=window.testOvvConfig&&window.testOvvConfig.userAgent?window.testOvvConfig.userAgent:navigator.userAgent;function g(k){var j=function(){var q={ID:0,name:"",version:""};var p=k;for(var n=0;n<l.length;n++){if(p.match(new RegExp(l[n].brRegex))!=null){q.ID=l[n].id;q.name=l[n].name;if(l[n].verRegex==null){break}var o=p.match(new RegExp(l[n].verRegex+"[0-9]*"));if(o!=null){var m=o[0].match(new RegExp(l[n].verRegex));q.version=o[0].replace(m[0],"")}break}}return q};var l=[{id:4,name:"Opera",brRegex:"OPR|Opera",verRegex:"(OPR/|Version/)"},{id:1,name:"MSIE",brRegex:"MSIE|Trident/7.*rv:11|rv:11.*Trident/7",verRegex:"(MSIE |rv:)"},{id:2,name:"Firefox",brRegex:"Firefox",verRegex:"Firefox/"},{id:3,name:"Chrome",brRegex:"Chrome",verRegex:"Chrome/"},{id:5,name:"Safari",brRegex:"Safari|(OS |OS X )[0-9].*AppleWebKit",verRegex:"Version/"}];return j()}this.browserIDEnum={MSIE:1,Firefox:2,Chrome:3,Opera:4,safari:5};this.browser=g(h);this.interval=Number("INTERVAL");this.version="VERSION";var d={};var c=[];var f=1000;var a=[];this.addAsset=function(j){if(!d.hasOwnProperty(j.getId())){d[j.getId()]=j;this.asset=j}};this.removeAsset=function(j){delete d[j.getId()]};this.getAssetById=function(j){return d[j]};this.getAds=function(){var k={};for(var j in d){if(d.hasOwnProperty(j)){k[j]=d[j]}}return k};this.subscribe=function(k,j,l,m){if(m){for(key in c[j]){if(b(c[j][key].eventName,k)){e(function(){l(j,c[j][key])})}}}for(key in k){if(!a[k[key]+j]){a[k[key]+j]=[]}a[k[key]+j].push({Func:l})}};this.publish=function(l,o,m){var k={eventName:l,eventTime:i(),ovvArgs:m};if(!c[o]){c[o]=[]}if(c[o].length<f){c[o].push(k)}if(l&&o&&a[l+o] instanceof Array){for(var n=0;n<a[l+o].length;n++){var j=a[l+o][n];if(j&&j.Func&&typeof j.Func==="function"){e(function(){j.Func(o,k)})}}}};var i=function(){if(Date.now){return Date.now()}return(new Date()).getTime()};var b=function(k,l){for(var j=0;j<l.length;j++){if(l[j]===k){return true}}return false};var e=function(k){try{var j=k();return j!==undefined?j:true}catch(l){return false}}}function OVVCheck(){this.clientHeight=-1;this.clientWidth=-1;this.error="";this.focus=null;this.fps=-1;this.id="";this.beaconsSupported=null;this.geometrySupported=null;this.geometryViewabilityState="";this.beaconViewabilityState="";this.technique="";this.beacons=new Array();this.inIframe=null;this.objBottom=-1;this.objLeft=-1;this.objRight=-1;this.objTop=-1;this.percentViewable=-1;this.viewabilityState=""}OVVCheck.UNMEASURABLE="unmeasurable";OVVCheck.VIEWABLE="viewable";OVVCheck.UNVIEWABLE="unviewable";OVVCheck.NOT_READY="not_ready";OVVCheck.BEACON="beacon";OVVCheck.GEOMETRY="geometry";function OVVAsset(p){var u=13;var G=Math.sqrt(2);var b=0;var F=1;var m=2;var z=3;var E=4;var A=5;var e=6;var x=7;var c=8;var l=9;var d=10;var D=11;var s=12;var h=13;var t=p;var y=0;var C=$ovv.DEBUG?20:1;var g;var v;var k=null;this.checkViewability=function(){var J=new OVVCheck();J.id=t;J.inIframe=$ovv.IN_IFRAME;J.geometrySupported=!$ovv.IN_IFRAME;J.focus=f();if(!v){J.error="Player not found!";return J}if(($ovv.browser.ID===$ovv.browserIDEnum.MSIE||$ovv.browser.ID===$ovv.browserIDEnum.Firefox)&&$ovv.IN_IFRAME){J.viewabilityState=OVVCheck.UNMEASURABLE;if(!$ovv.DEBUG){return J}}if(J.geometrySupported){J.technique=OVVCheck.GEOMETRY;j.bind(this)(J,v);J.viewabilityState=(J.percentViewable>=50)?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE;if($ovv.DEBUG){J.geometryViewabilityState=J.viewabilityState}else{return J}}var M=B(0);if(M&&M.isViewable){var L=i(M)&&M.isViewable();J.beaconsSupported=!L}else{J.beaconsSupported=false}if(!o()){J.technique=OVVCheck.BEACON;J.viewabilityState=OVVCheck.NOT_READY}else{if(J.beaconsSupported){J.technique=OVVCheck.BEACON;var I=a.bind(this)(J);if(I===null){J.viewabilityState=OVVCheck.UNMEASURABLE;if($ovv.DEBUG){J.beaconViewabilityState=OVVCheck.UNMEASURABLE}}else{J.viewabilityState=I?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE;if($ovv.DEBUG){J.beaconViewabilityState=I?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE}}}else{J.viewabilityState=OVVCheck.UNMEASURABLE}}if($ovv.DEBUG){J.technique="";if(J.geometryViewabilityState===null&&J.beaconViewabilityState===null){J.viewabilityState=OVVCheck.UNMEASURABLE}else{var K=(J.beaconViewabilityState===OVVCheck.VIEWABLE);var H=(J.geometryViewabilityState===OVVCheck.VIEWABLE);J.viewabilityState=(K||H)?OVVCheck.VIEWABLE:OVVCheck.UNVIEWABLE}}return J};this.beaconStarted=function(H){if($ovv.DEBUG){B(H).debug()}if(H===0){return}y++;if(o()){v.onJsReady()}};this.dispose=function(){for(var I=1;I<=u;I++){var H=q(I);if(H){delete y[I];H.parentElement.removeChild(H)}}clearInterval(window.$ovv.positionInterval);window.$ovv.removeAsset(this)};this.getId=function(){return t};this.getPlayer=function(){return v};var j=function(I,O){I.clientWidth=Infinity;I.clientHeight=Infinity;if(!isNaN(document.body.clientWidth)&&document.body.clientWidth>0){I.clientWidth=document.body.clientWidth}if(!isNaN(document.body.clientHeight)&&document.body.clientHeight>0){I.clientHeight=document.body.clientHeight}if(!!document.documentElement&&!!document.documentElement.clientWidth&&!isNaN(document.documentElement.clientWidth)){I.clientWidth=document.documentElement.clientWidth}if(!!document.documentElement&&!!document.documentElement.clientHeight&&!isNaN(document.documentElement.clientHeight)){I.clientHeight=document.documentElement.clientHeight}if(!!window.innerWidth&&!isNaN(window.innerWidth)){I.clientWidth=Math.min(I.clientWidth,window.innerWidth)}if(!!window.innerHeight&&!isNaN(window.innerHeight)){I.clientHeight=Math.min(I.clientHeight,window.innerHeight)}if(I.clientHeight==Infinity||I.clientWidth==Infinity){I={error:"Failed to determine viewport"}}else{var K=O.getClientRects()[0];I.objTop=K.top;I.objBottom=K.bottom;I.objLeft=K.left;I.objRight=K.right;if(K.bottom<0||K.right<0||K.top>I.clientHeight||K.left>I.clientWidth){I.percentViewable=0}else{var N=(K.right-K.left)*(K.bottom-K.top);var H=Math.ceil(Math.max(0,K.left));var M=Math.floor(Math.min(I.clientWidth,K.right));var P=Math.ceil(Math.max(0,K.top));var L=Math.floor(Math.min(I.clientHeight,K.bottom));var J=(M-H+1)*(L-P+1);I.percentViewable=Math.floor(J/N*100)}}};var a=function(H){if(!o()){return null}var O=0;var L=0;var Q=0;var R=0;H.beacons=new Array(u);var K=v.getClientRects()[0];H.objTop=K.top;H.objBottom=K.bottom;H.objLeft=K.left;H.objRight=K.right;for(var M=0;M<=u;M++){if(M===0){continue}var I=B(M);var J=I.isViewable();var P=i(I);H.beacons[M]=J&&P;if(J){O++;switch(M){case m:case z:case E:case A:L++;break;case e:case x:case c:case l:Q++;break;case d:case D:case s:case h:R++;break}}}if(O===u){return true}var N=H.beacons;if((N[F]===true)&&(N[m]===true&&N[z]==true)||(N[m]===true&&N[E]==true)||(N[z]===true&&N[A]==true)||(N[E]===true&&N[A]==true)){return true}if(N[F]===false&&R>=3){return true}if(N[F]===true&&Q==4){return true}if((N[m]&&N[A])&&(!N[e]||![d]||!N[F]||N[h]||N[l])){return null}if((N[E]&&N[z])&&(!N[c]||!N[s]||!N[F]||!N[D]||!N[x])){return null}return false};var o=function(){if(!v){return false}return y===u};var r=function(I){if(I===""||I===("BEACON_SWF_URL")){return}for(var H=0;H<=u;H++){var K=document.createElement("DIV");K.id="OVVBeaconContainer_"+H+"_"+t;K.style.position="absolute";K.style.zIndex=$ovv.DEBUG?99999:-99999;var J='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+C+'" height="'+C+'"><param name="movie" value="'+I+"?id="+t+"&index="+H+'" /><param name="quality" value="low" /><param name="bgcolor" value="#ffffff" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><!--[if !IE]>--><object id="OVVBeacon_'+H+"_"+t+'" type="application/x-shockwave-flash" data="'+I+"?id="+t+"&index="+H+'" width="'+C+'" height="'+C+'"><param name="quality" value="low" /><param name="bgcolor" value="#ff0000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><!--<![endif]--></object>';K.innerHTML=J;document.body.insertBefore(K,document.body.firstChild)}w.bind(this)();this.positionInterval=setInterval(w.bind(this),500)};var w=function(){if(!o()){return}var K=v.getClientRects()[0];if(g&&(g.left===K.left&&g.right===K.right&&g.top===K.top&&g.bottom===K.bottom)){return}g=K;var I=K.right-K.left;var Q=K.bottom-K.top;var N=I/(1+G);var H=Q/(1+G);var L=I/G;var P=Q/G;for(var M=0;M<=u;M++){var J=K.left+document.body.scrollLeft;var O=K.top+document.body.scrollTop;switch(M){case b:J=-100000;O=-100000;break;case F:J+=(I-C)/2;O+=(Q-C)/2;break;case m:break;case z:J+=I-C;break;case E:O+=Q-C;break;case A:J+=I-C;O+=Q-C;break;case e:J+=(I-L)/2;O+=(Q-P)/2;break;case x:J+=((I-L)/2)+L;O+=(Q-P)/2;break;case c:J+=(I-L)/2;O+=((Q-P)/2)+P;break;case l:J+=((I-L)/2)+L;O+=((Q-P)/2)+P;break;case d:J+=(I-N)/2;O+=(Q-H)/2;break;case D:J+=((I-N)/2)+N;O+=(Q-H)/2;break;case s:J+=(I-N)/2;O+=((Q-H)/2)+H;break;case h:J+=((I-N)/2)+N;O+=((Q-H)/2)+H;break}if(M>=e){J-=(C/2);O-=(C/2)}var R=q(M);R.style.left=J+"px";R.style.top=O+"px"}};var i=function(H){if(!H){return false}var I=Math.max(document.body.clientWidth,window.innerWidth);var K=Math.max(document.body.clientHeight,window.innerHeight);var J=H.getClientRects()[0];return(J.top<K&&J.bottom>0&&J.left<I&&J.right>0)};var B=function(H){return document.getElementById("OVVBeacon_"+H+"_"+t)};var q=function(H){return document.getElementById("OVVBeaconContainer_"+H+"_"+t)};var n=function(){var I=document.getElementsByTagName("embed");for(var H=0;H<I.length;H++){if(I[H][t]){return I[H]}}var J=document.getElementsByTagName("object");for(var H=0;H<J.length;H++){if(J[H][t]){return J[H]}}return null};var f=function(){var H=true;if(typeof document.hidden!=="undefined"){H=window.document.hidden?false:true}else{if(document.hasFocus){H=document.hasFocus()}}if($ovv.IN_IFRAME===false&&H===true&&document.hasFocus){H=document.hasFocus()}return H};v=n();if($ovv.IN_IFRAME||$ovv.DEBUG){r.bind(this)("BEACON_SWF_URL")}else{if(v&&v.onJsReady){setTimeout(function(){v.onJsReady()},5)}}}window.$ovv=window.$ovv||new OVV();window.$ovv.addAsset(new OVVAsset("OVVID"));